<script src="<?php echo base_url()?>template/jquery.min.js"></script><script src="<?php echo base_url()?>template/assets/vendors/js/vendor.bundle.base.js"></script><script src="<?php echo base_url()?>template/assets/vendors/js/vendor.bundle.addons.js"></script><script src="<?php echo base_url()?>template/DataTables/datatables.js"></script><script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script><script src="<?php echo base_url()?>template/assets/js/shared/off-canvas.js"></script><script src="<?php echo base_url()?>template/assets/js/shared/misc.js"></script><script src="<?php echo base_url()?>template/assets/js/demo_1/dashboard.js"></script><script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script><script type="text/javascript">$(document).ready( function () {$('select').select2({theme: 'classic'});var table = $('#myTable').DataTable({<?php if($this->session->userdata('Role') == 1){ ?>ajax: '<?php echo base_url()?>Cabang/get_cabang_all',<?php }else{ ?>ajax: '<?php echo base_url()?>Cabang/get_cabang',<?php }?>columns: [{ data: 'IdCabang' },{ data: 'Nama' },{ data: 'Alamat' },{data: null,className: "dt-center updateCabang",defaultContent: '<button class="btn btn-warning updateCabang" data-toggle="modal" data-target="#modalCabang"><i class="fa fa-pencil"></i> Update</button>',orderable: false},{data: null,className: "dt-center deleteCabang",defaultContent: '<button class="btn btn-danger delete"><i class="fa fa-trash"></i> Delete</button'}]});$.fn.dataTable.ext.errMode = 'none';function validation() {if ($('#nama').val() == '') {Swal.fire({icon: 'error',title: 'Oops...',text: "Nama Tidak Boleh Kosong",});return false;}else if ($('#alamat').val() == '') {Swal.fire({icon: 'error',title: 'Oops...',text: "Alamat Tidak Boleh Kosong",});return false;}else{return true;}}$("#addCabang").on("click", function() {$('#updateForm').hide();$('#addForm').show();$('#idCabang').prop('disabled', true);$('#nama').val('');$('#alamat').val('');$('#idPerusahaan').val('');$('#idPerusahaan').trigger('change');});$("#addForm").on("click", function() {$("#addForm").prop('disabled', true);if (validation() == true) {$.ajax({type: "post",url: "<?php echo base_url() ?>Cabang/post_cabang",data: "Nama="+$('#nama').val()+"&Alamat="+$('#alamat').val()+"&IdPerusahaan="+$('#idPerusahaan').val(),dataType: "json",success: function (hasil) {$("#addForm").prop('disabled', false);$('#modalCabang').modal().hide();$(".modal-backdrop").remove();if (!hasil.message) {Swal.fire('Berhasil!','Berhasil Menambahkan = '+hasil[0].affectedRows+' Data','success');table.ajax.reload();}else{Swal.fire({icon: 'error',title: 'Oops...',text: hasil.message,})}                    }});} else {$("#addForm").prop('disabled', false);}});$("#myTable").on("click", 'td.updateCabang', function() {$("#updateForm").prop('disabled', false);console.log(table.row(this).data());const data = table.row(this).data();$('#updateForm').show();$('#addForm').hide();$('#idCabang').prop('disabled', false);$('#idCabang').val(data.IdCabang);$('#nama').val(data.Nama);$('#alamat').val(data.Alamat);$('#idPerusahaan').val(data.IdPerusahaan);$('#idPerusahaan').trigger('change');});$("#updateForm").on("click", function() {$("#updateForm").prop('disabled', true);if (validation() == true) {$.ajax({type: "post",url: "<?php echo base_url() ?>Cabang/put_cabang",data: "IdCabang="+$('#idCabang').val()+"&Nama="+$('#nama').val()+"&Alamat="+$('#alamat').val()+"&IdPerusahaan="+$('#idPerusahaan').val(),dataType: "json",success: function (hasil) {$("#updateForm").prop('disabled', false);$('#modalCabang').modal().hide();$(".modal-backdrop").remove();if (!hasil.message) {Swal.fire('Berhasil!','Berhasil '+hasil[0].info,'success');table.ajax.reload();}else{Swal.fire({icon: 'error',title: 'Oops...',text: hasil.message,})}}});} else {$("#updateForm").prop('disabled', false);}});$("#myTable").on("click", 'td.deleteCabang', function() {console.log(table.row(this).data());const data = table.row(this).data();Swal.fire({title: 'Are you sure?',text: "You won't be able to revert this!",icon: 'warning',showCancelButton: true,confirmButtonColor: '#3085d6',cancelButtonColor: '#d33',confirmButtonText: 'Yes, delete it!'}).then((result) => {if (result.isConfirmed) {$.ajax({type: "post",url: "<?php echo base_url() ?>Cabang/delete_cabang",data: "IdCabang="+data.IdCabang,dataType: "json",success: function (hasil) {if (!hasil.message) {Swal.fire('Deleted!','Your file has been deleted.','success');table.ajax.reload();}else{Swal.fire({icon: 'error',title: 'Oops...',text: hasil.message,})}}});}})})} );</script>