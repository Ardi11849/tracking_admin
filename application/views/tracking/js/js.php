<script type="text/javascript" src="<?php echo base_url()?>template/jquery.min.js"></script><script src="<?php echo base_url()?>template/assets/vendors/js/vendor.bundle.base.js"></script><script src="<?php echo base_url()?>template/assets/vendors/js/vendor.bundle.addons.js"></script><script src="<?php echo base_url()?>template/assets/js/shared/off-canvas.js"></script><script src="<?php echo base_url()?>template/assets/js/shared/misc.js"></script><script src="https://unpkg.com/@google/markerclustererplus@4.0.1/dist/markerclustererplus.min.js"></script><script src="<?php echo base_url()?>template/assets/js/demo_1/dashboard.js"></script><script type="text/javascript">var locationsAll = [];var locations = [];var onClick = [];$("#cardMap").hide();$("#search").on("keyup", function() {var value = $(this).val().toLowerCase();$("#area span").filter(function() {$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)});});function click(){for (var i = locationsAll.length - 1; i >= 0; i--) {$("#lacakid"+[i]).on("click", function(){onClick.length = 0;onClick.push(this.id);locations.length = 0;setInterval(locations.push({lat: $(this).data("lat"), lng: $(this).data("lng")}), 5000);console.log(locations[0]['lat']);$("#cardMap").show('show');initMap();console.log(onClick[0]);})}}setInterval(function(){panggilAjax(); $("#"+onClick[0]).click()}, 10000);panggilAjax();function panggilAjax() {$.ajax({type: "get",url: "<?php echo base_url()?>Tracking/get_tracking",dataType: "json",success: function (hasil) {console.log(hasil);locationsAll.length = 0;for (var i = hasil.data.length - 1; i >= 0; i--) {var isi = '<div class="col-md-6 grid-margin stretch-card"><div class="card"><div class="card-body"><div class="row"><div class="col-md-6"><div class="d-flex align-items-center pb-2"><div class="dot-indicator bg-danger mr-2"></div><p class="mb-0">'+hasil.data[i].Nama+'</p></div><h4 class="font-weight-semibold">Lat = '+hasil.data[i].latitude+'</h4></div><div class="col-md-6 mt-4 mt-md-0"><div class="d-flex align-items-center pb-2"><div class="dot-indicator bg-success mr-2"></div><p class="mb-0" id="IdKurir">'+hasil.data[i].IdKurir+'</p></div><h4 class="font-weight-semibold">Lon = '+hasil.data[i].longitude+'</h4><button data-Id = '+hasil.data[i].IdKurir+' data-lat = '+hasil.data[i].latitude+' data-lng = '+hasil.data[i].longitude+' id = "lacakid'+[i]+'">Lacak Pengendara</button></div></div></div></div></div>';if ($("#IdKurir").text() == hasil.data[i].IdKurir) {$("#area").html(isi)}else{$("#area").append(isi)}locationsAll.push({lat: parseFloat(hasil.data[i].latitude), lng: parseFloat(hasil.data[i].longitude)})}click()}});}function initMap() {console.log(locations[0]);const map = new google.maps.Map(document.getElementById("map"), {zoom: 18,center: locations[0],});const labels = "Tracking";const markers = locations.map((location, i) => {return new google.maps.Marker({position: location,label: labels[i % labels.length],});});new MarkerClusterer(map, markers, {imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",});}</script><script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCoX47JuBWAsqKkhyIA1ofM0vufpMfSM&callback=initMap&libraries=&v=weekly"async></script>